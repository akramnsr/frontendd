<div class="container mt-4" *ngIf="quiz as qz">
  <h2>{{ qz.titre }}</h2>



  <!-- Affichage du QCM -->
  <div *ngIf="qz.questions.length">
    <div class="qcm-question-box">
      <div class="qcm-progress">Question {{ current + 1 }} / {{ qz.questions.length }}</div>
      <div class="qcm-question">{{ qz.questions[current].libelle }}</div>
      <ul class="qcm-choices">
        <li *ngFor="let ch of qz.questions[current].choices; let c = index">
          <label>
            <input type="radio"
                   name="qcm-{{ current }}"
                   [checked]="answers[current] === c"
                   [disabled]="validated"
                   (change)="selectAnswer(current, c)">
            {{ ch.texte }}
            <span *ngIf="validated && ch.correct" class="correct-icon">✔</span>
            <span *ngIf="validated && answers[current] === c && !ch.correct" class="wrong-icon">✘</span>
          </label>
        </li>
      </ul>
    </div>

    <div class="qcm-navigation">
      <button class="btn btn-outline-secondary" (click)="previous()" [disabled]="current === 0">← Précédent</button>
      <button class="btn btn-outline-secondary" (click)="next()" [disabled]="current === qz.questions.length - 1">Suivant →</button>
      <button class="btn btn-primary" (click)="validate()" [disabled]="validated || answers.includes(-1)">Valider le QCM</button>
      <button *ngIf="validated" class="btn btn-secondary" (click)="reset()">Recommencer</button>
    </div>
    <div *ngIf="validated" class="qcm-score mt-3">
      <h4>Score : {{ score }} / {{ qz.questions.length }}</h4>
    </div>
  </div>
</div>
